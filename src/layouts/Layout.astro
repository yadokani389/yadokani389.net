---
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";
import "../styles/global.css";

const { title, description } = Astro.props;
const pageTitle = title ? `${title} | ${SITE_TITLE}` : SITE_TITLE;
const pageDescription = description ?? SITE_DESCRIPTION;
const pathname = Astro.url.pathname;
const normalizedPath =
  pathname !== "/" && pathname.endsWith("/") ? pathname.slice(0, -1) : pathname;
const navItems = [
  { href: "/", label: "Home" },
  { href: "/blog", label: "Blog" },
  { href: "/works", label: "Works" },
  { href: "/about", label: "About" },
];
---

<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{pageTitle}</title>
    <meta name="description" content={pageDescription} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <a class="skip-link" href="#main">本文へスキップ</a>
    <header class="site-header">
      <div class="header-inner">
        <a class="brand" href="/">{SITE_TITLE}</a>
        <nav class="nav" aria-label="Main">
          {
            navItems.map((item) => (
              <a
                href={item.href}
                aria-current={normalizedPath === item.href ? "page" : undefined}
              >
                {item.label}
              </a>
            ))
          }
        </nav>
      </div>
    </header>
    <main id="main">
      <slot />
    </main>
    <footer class="site-footer">
      <div class="footer-inner">
        <span>© 2026 {SITE_TITLE}</span>
        <div class="footer-links">
          <a
            class="footer-link"
            href="https://github.com/yadokani389"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="GitHub"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path
                fill="currentColor"
                d="M12 2C6.5 2 2 6.6 2 12.2c0 4.5 2.9 8.3 6.9 9.6.5.1.7-.2.7-.5v-1.8c-2.8.6-3.4-1.2-3.4-1.2-.4-1.1-1-1.4-1-1.4-.9-.6.1-.6.1-.6 1 .1 1.6 1.1 1.6 1.1.9 1.6 2.4 1.1 3 .9.1-.7.4-1.1.7-1.4-2.2-.3-4.5-1.1-4.5-5 0-1.1.4-2 1-2.7-.1-.3-.4-1.3.1-2.7 0 0 .8-.3 2.8 1a9.6 9.6 0 0 1 5 0c2-1.3 2.8-1 2.8-1 .5 1.4.2 2.4.1 2.7.6.7 1 1.6 1 2.7 0 3.9-2.3 4.7-4.5 5 .4.4.7 1 .7 2v2.9c0 .3.2.6.7.5 4-1.3 6.9-5.1 6.9-9.6C22 6.6 17.5 2 12 2Z"
              ></path>
            </svg>
          </a>
          <a
            class="footer-link"
            href="https://x.com/yadokani389"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="X"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path
                fill="currentColor"
                d="M18.9 3h2.9l-6.4 7.3L22.9 21h-6.3l-4.9-6.3L6 21H3l6.9-7.9L1.5 3h6.5l4.4 5.7L18.9 3Zm-1 16.3h1.6L6.2 4.5H4.5l13.4 14.8Z"
              ></path>
            </svg>
          </a>
          <a
            class="footer-link"
            href="https://zenn.dev/yadokani389"
            target="_blank"
            rel="noopener noreferrer"
          >
            Zenn
          </a>
        </div>
      </div>
    </footer>
    <script is:inline>
      document.addEventListener("click", (event) => {
        const target = event.target;
        if (!(target instanceof Element)) return;
        if (target.closest("a, button, input, textarea, select")) return;
        const card = target.closest("[data-card-link]");
        if (!card) return;
        const href = card.getAttribute("data-href");
        if (href) {
          window.location.href = href;
        }
      });

      document.addEventListener("keydown", (event) => {
        if (event.key !== "Enter" && event.key !== " ") return;
        const active = document.activeElement;
        if (!(active instanceof Element)) return;
        if (active.closest("a, button, input, textarea, select")) return;
        const card = active.closest("[data-card-link]");
        if (!card) return;
        const href = card.getAttribute("data-href");
        if (href) {
          event.preventDefault();
          window.location.href = href;
        }
      });
    </script>
  </body>
</html>

<style>
  .skip-link {
    position: absolute;
    left: -9999px;
    top: auto;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }

  .skip-link:focus {
    left: var(--gutter);
    top: 16px;
    width: auto;
    height: auto;
    padding: 8px 12px;
    background: var(--card);
    border-radius: 999px;
    border: 1px solid var(--border);
    z-index: 100;
  }
</style>
