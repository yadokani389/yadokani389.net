---
import { getCollection } from "astro:content";
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";
import Layout from "../layouts/Layout.astro";

const works = (await getCollection("works"))
  .sort((a, b) => a.data.title.localeCompare(b.data.title))
  .slice(0, 5);
const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 3);
---

<Layout title="Home" description={SITE_DESCRIPTION}>
  <div class="container">
    <section class="hero">
      <h1>{SITE_TITLE}</h1>
      <p>
        {SITE_DESCRIPTION}
      </p>
      <div class="hero-actions">
        <a class="button primary" href="/blog">Blogを見る</a>
        <a class="button" href="/works">Worksを見る</a>
      </div>
    </section>

    <section class="section">
      <div class="section-header">
        <h2>Blog</h2>
        <a href="/blog">一覧へ</a>
      </div>
      <div class="list-stack">
        {
          posts.map((post) => (
            <a class="card" href={`/blog/${post.id}`}>
              <div>
                <h3 class="card-title">{post.data.title}</h3>
                <p class="card-description">{post.data.description}</p>
              </div>
            </a>
          ))
        }
      </div>
    </section>

    <section class="section">
      <div class="section-header">
        <h2>Works</h2>
        <a href="/works">一覧へ</a>
      </div>
      <div class="list-stack">
        {
          works.map((work) => (
            <a class="card" href={`/works/${work.id}`}>
              <div>
                <h3 class="card-title">{work.data.title}</h3>
                <p class="card-description">{work.data.description}</p>
              </div>
            </a>
          ))
        }
      </div>
    </section>
  </div>
</Layout>
