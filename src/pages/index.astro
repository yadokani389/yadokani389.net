---
import { getCollection } from "astro:content";
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";
import Layout from "../layouts/Layout.astro";

const works = (await getCollection("works"))
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 5);
const posts = (await getCollection("blog"))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 3);
---

<Layout title="Home" description={SITE_DESCRIPTION}>
  <div class="mx-auto flex max-w-5xl flex-col gap-12 pb-6">
    <section
      class="relative overflow-hidden rounded-2xl border border-sand-100 bg-white p-8 shadow-lift before:absolute before:-right-16 before:-top-16 before:h-48 before:w-48 before:rounded-full before:bg-clay-300/40 before:blur-3xl before:content-[''] md:p-10"
    >
      <p class="text-xs font-semibold tracking-[0.12em] text-ink-500">
        ようこそ
      </p>
      <h1 class="mt-2 text-4xl font-display text-ink-900 md:text-5xl">
        {SITE_TITLE}
      </h1>
      <p class="mt-3 max-w-2xl text-base leading-relaxed text-ink-600">
        {SITE_DESCRIPTION}
      </p>
      <div class="mt-6 flex flex-wrap gap-3">
        <a
          class="inline-flex items-center gap-2 rounded-full bg-sage-600 px-6 py-2.5 text-sm font-semibold text-white shadow-glow transition hover:bg-sage-700"
          href="/blog"
        >
          Blogを見る
        </a>
        <a
          class="inline-flex items-center gap-2 rounded-full border border-sand-300 bg-white px-6 py-2.5 text-sm font-semibold text-ink-600 transition hover:border-sage-500/40 hover:text-ink-800"
          href="/works"
        >
          Worksを見る
        </a>
      </div>
    </section>

    <section class="space-y-6">
      <div class="flex flex-wrap items-end justify-between gap-4">
        <div>
          <p class="text-xs font-semibold tracking-[0.12em] text-ink-500">
            最新のブログ
          </p>
          <h2 class="mt-1 text-2xl font-display text-ink-900 md:text-3xl">
            Blog
          </h2>
        </div>
        <a
          class="inline-flex items-center gap-1 text-sm font-semibold text-ink-600 hover:text-sage-600"
          href="/blog"
        >
          一覧へ
          <span aria-hidden="true">→</span>
        </a>
      </div>
      <div class="grid gap-6 md:grid-cols-2">
        {
          posts.map((post) => (
            <a
              class="group flex h-full flex-col justify-between rounded-2xl border border-sand-200 bg-white p-6 transition hover:border-sage-500/40 hover:shadow-soft"
              href={`/blog/${post.id}`}
            >
              <div>
                <h3 class="text-xl font-display text-ink-900">
                  {post.data.title}
                </h3>
                <p class="mt-2 text-sm leading-relaxed text-ink-600">
                  {post.data.description}
                </p>
              </div>
              <span class="mt-5 inline-flex items-center gap-2 text-sm font-semibold text-sage-600">
                記事を読む
              </span>
            </a>
          ))
        }
      </div>
    </section>

    <section class="space-y-6">
      <div class="flex flex-wrap items-end justify-between gap-4">
        <div>
          <p class="text-xs font-semibold tracking-[0.12em] text-ink-500">
            最近の作品
          </p>
          <h2 class="mt-1 text-2xl font-display text-ink-900 md:text-3xl">
            Works
          </h2>
        </div>
        <a
          class="inline-flex items-center gap-1 text-sm font-semibold text-ink-600 hover:text-sage-600"
          href="/works"
        >
          一覧へ
          <span aria-hidden="true">→</span>
        </a>
      </div>
      <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {
          works.map((work) => (
            <a
              class="group flex h-full flex-col justify-between rounded-2xl border border-sand-200 bg-white p-6 transition hover:border-sage-500/40 hover:shadow-soft"
              href={`/works/${work.id}`}
            >
              <div>
                <h3 class="text-xl font-display text-ink-900">
                  {work.data.title}
                </h3>
                <p class="mt-2 text-sm leading-relaxed text-ink-600">
                  {work.data.description}
                </p>
              </div>
              <span class="mt-5 inline-flex items-center gap-2 text-sm font-semibold text-sage-600">
                詳細を見る
              </span>
            </a>
          ))
        }
      </div>
    </section>
  </div>
</Layout>
